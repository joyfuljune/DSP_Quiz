<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DTFT/DFS/Zå˜æ¢ç»¼åˆæµ‹éªŒ</title>
    
    <!-- ä¿®æ”¹ç‚¹ï¼šä½¿ç”¨ç¨³å®šå¯é çš„å®˜æ–¹CDNåŠ è½½MathJaxè„šæœ¬ -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2em;
        }

        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        /* å¼€å§‹ç•Œé¢æ ·å¼ */
        .start-screen {
            text-align: center;
            padding: 20px;
        }

        .info-form {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 30px;
            margin: 30px 0;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            color: #2c3e50;
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #3498db;
        }

        .exam-info {
            background: #e8f4f8;
            border-left: 4px solid #3498db;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        .exam-info h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .exam-info ul {
            margin-left: 20px;
            color: #34495e;
            line-height: 1.8;
        }

        .progress-bar {
            background: #ecf0f1;
            height: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            background: linear-gradient(90deg, #3498db, #2ecc71);
            height: 100%;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .question-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px solid #dee2e6;
            transition: all 0.3s;
        }

        .question-card.answered {
            border-color: #3498db;
            background: #e8f4f8;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .question-number {
            background: #3498db;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .question-category {
            background: #95a5a6;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85em;
        }

        .question-category.dtft {
            background: #e74c3c;
        }

        .question-category.dfs {
            background: #f39c12;
        }

        .question-category.ztransform {
            background: #27ae60;
        }

        .question-category.system {
            background: #8e44ad;
        }

        .question-text {
            font-size: 1.1em;
            color: #2c3e50;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .option:hover {
            background: #f8f9fa;
            border-color: #3498db;
            transform: translateX(5px);
        }

        .option.selected {
            background: #e8f4f8;
            border-color: #3498db;
            border-width: 3px;
        }

        .option.correct {
            background: #d4edda;
            border-color: #28a745;
            border-width: 3px;
        }

        .option.incorrect {
            background: #f8d7da;
            border-color: #dc3545;
            border-width: 3px;
        }

        .option-label {
            background: #3498db;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .option.correct .option-label {
            background: #28a745;
        }

        .option.incorrect .option-label {
            background: #dc3545;
        }

        .option-text {
            flex: 1;
            color: #2c3e50;
        }

        .explanation {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            display: none;
        }

        .explanation.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .explanation h4 {
            color: #856404;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .explanation p {
            color: #856404;
            line-height: 1.6;
        }

        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        button {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-submit {
            background: #3498db;
            color: white;
        }

        .btn-next {
            background: #2ecc71;
            color: white;
        }

        .btn-prev {
            background: #95a5a6;
            color: white;
        }

        .btn-finish {
            background: #e74c3c;
            color: white;
        }

        .btn-start {
            background: #3498db;
            color: white;
            padding: 15px 50px;
            font-size: 1.2em;
        }

        .result-panel {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            display: none;
        }

        .result-panel.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .student-info {
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            font-size: 1.2em;
        }

        .student-info p {
            margin: 5px 0;
        }

        .result-score {
            font-size: 4em;
            font-weight: bold;
            margin: 20px 0;
        }

        .result-message {
            font-size: 1.5em;
            margin-bottom: 20px;
        }

        .result-details {
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .result-details table {
            width: 100%;
            border-collapse: collapse;
        }

        .result-details td {
            padding: 10px;
            font-size: 1.1em;
        }

        .review-section {
            margin-top: 30px;
        }

        .review-question {
            background: white;
            color: #2c3e50;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ecf0f1;
        }

        .review-status {
            padding: 5px 15px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .review-status.correct {
            background: #d4edda;
            color: #155724;
        }

        .review-status.wrong {
            background: #f8d7da;
            color: #721c24;
        }

        .statistics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            background: white;
            color: #2c3e50;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            margin: 10px 0;
        }

        .stat-label {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 1.5em;
            }

            .button-group {
                flex-direction: column;
            }

            button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>DTFT/DFS/Zå˜æ¢ç»¼åˆæµ‹éªŒ</h1>
        <p class="subtitle">å—äº¬å·¥ä¸šå¤§å­¦æµ¦æ±Ÿå­¦é™¢ | DSP</p>

        <!-- å¼€å§‹ç•Œé¢ -->
        <div id="startScreen" class="start-screen">
            <div class="exam-info">
                <h3>ğŸ“‹ æµ‹éªŒè¯´æ˜</h3>
                <ul>
                    <li>å…±20é“é€‰æ‹©é¢˜ï¼Œæ¶µç›–DTFTã€DFSã€Zå˜æ¢ç­‰æ ¸å¿ƒçŸ¥è¯†ç‚¹</li>
                    <li>æ¯é¢˜1åˆ†ï¼Œæ€»åˆ†20åˆ†</li>
                    <li>ç‚¹å‡»é€‰é¡¹é€‰æ‹©ç­”æ¡ˆ,å¯ä»¥éšæ—¶ä¿®æ”¹</li>
                    <li>æäº¤åå¯æŸ¥çœ‹è¯¦ç»†è§£æå’Œæ­£ç¡®ç­”æ¡ˆ</li>
                </ul>
            </div>

            <div class="info-form">
                <h3 style="color: #2c3e50; margin-bottom: 20px;">è¯·å¡«å†™ä½ çš„ä¿¡æ¯</h3>
                <div class="form-group">
                    <label for="studentId">å­¦å· <span style="color: red;">*</span></label>
                    <input type="text" id="studentId" placeholder="è¯·è¾“å…¥å­¦å·" required="">
                </div>
                <div class="form-group">
                    <label for="studentName">å§“å <span style="color: red;">*</span></label>
                    <input type="text" id="studentName" placeholder="è¯·è¾“å…¥å§“å" required="">
                </div>
                <button class="btn-start" onclick="startExam()">å¼€å§‹è€ƒè¯•</button>
            </div>
        </div>

        <!-- è€ƒè¯•ç•Œé¢ -->
        <div id="examScreen" style="display: none;">
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar">0/20 å·²å®Œæˆ</div>
            </div>

            <div id="questionContainer"></div>

            <div class="button-group">
                <button class="btn-prev" id="prevBtn" onclick="previousQuestion()">â¬…ï¸ ä¸Šä¸€é¢˜</button>
                <button class="btn-submit" id="submitBtn" onclick="submitAnswer()">âœ“ æäº¤ç­”æ¡ˆ</button>
                <button class="btn-next" id="nextBtn" onclick="nextQuestion()">ä¸‹ä¸€é¢˜ â¡ï¸</button>
                <button class="btn-finish" id="finishBtn" onclick="finishExam()" style="display: none;">ğŸ å®Œæˆè€ƒè¯•</button>
            </div>
        </div>

        <!-- ç»“æœç•Œé¢ -->
        <div class="result-panel" id="resultPanel">
            <h2>è€ƒè¯•å®Œæˆï¼</h2>
            
            <div class="student-info">
                <p><strong>å­¦å·ï¼š</strong><span id="resultStudentId"></span></p>
                <p><strong>å§“åï¼š</strong><span id="resultStudentName"></span></p>
            </div>

            <div class="result-score" id="resultScore">0/20</div>
            <div class="result-message" id="resultMessage"></div>
            
            <div class="statistics">
                <div class="stat-card">
                    <div class="stat-label">æ­£ç¡®ç‡</div>
                    <div class="stat-value" id="accuracyRate">0%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">DTFTé¢˜ç›®</div>
                    <div class="stat-value" id="dtftScore">0/5</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">DFSé¢˜ç›®</div>
                    <div class="stat-value" id="dfsScore">0/4</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Zå˜æ¢é¢˜ç›®</div>
                    <div class="stat-value" id="ztScore">0/6</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">ç³»ç»Ÿåˆ†æé¢˜ç›®</div>
                    <div class="stat-value" id="systemScore">0/5</div>
                </div>
            </div>

            <button class="btn-submit" onclick="showReview()" style="margin-top: 30px;">ğŸ“ æŸ¥çœ‹è¯¦ç»†è§£æ</button>
            <button class="btn-next" onclick="location.reload()" style="margin-top: 10px;">ğŸ”„ é‡æ–°å¼€å§‹</button>
        </div>

        <div id="reviewSection" style="display: none;">
            <h2 style="margin: 30px 0 20px 0; color: #2c3e50;">ğŸ“š ç­”é¢˜å›é¡¾ä¸è§£æ</h2>
            <div id="reviewContainer"></div>
        </div>
    </div>

    <script>
        const originalQuestions = [
            {
                id: 1,
                category: 'dtft',
                categoryName: 'DTFT',
                question: 'ç¦»æ•£æ—¶é—´å‚…é‡Œå¶å˜æ¢(DTFT)çš„å‘¨æœŸæ˜¯å¤šå°‘ï¼Ÿ',
                options: [
                    '$\\pi$',
                    '$2\\pi$',
                    '$\\pi/2$',
                    '$4\\pi$'
                ],
                correct: 1,
                explanation: 'DTFTçš„å®šä¹‰ä¸º $X(e^{j\\omega}) = \\sum_{n=-\\infty}^{\\infty} x[n]e^{-j\\omega n}$ã€‚ç”±äº $e^{j\\omega n}$ å…³äº $\\omega$ æ˜¯ä»¥ $2\\pi$ ä¸ºå‘¨æœŸçš„ï¼Œå› æ­¤DTFTä¹Ÿæ˜¯ä»¥ $2\\pi$ ä¸ºå‘¨æœŸçš„å‡½æ•°ã€‚'
            },
            {
                id: 2,
                category: 'dtft',
                categoryName: 'DTFT',
                question: 'å¦‚æœåºåˆ— $x[n]$ æ˜¯å®åºåˆ—ï¼Œåˆ™å…¶DTFT $X(e^{j\\omega})$ å…·æœ‰ä»€ä¹ˆæ€§è´¨ï¼Ÿ',
                options: [
                    'å…±è½­å¯¹ç§°æ€§ï¼š$X(e^{j\\omega}) = X^*(e^{-j\\omega})$',
                    'å…±è½­åå¯¹ç§°æ€§ï¼š$X(e^{j\\omega}) = -X^*(e^{-j\\omega})$',
                    'å‘¨æœŸä¸º $\\pi$',
                    'ä»…åœ¨ $[0, \\pi]$ æœ‰å®šä¹‰'
                ],
                correct: 0,
                explanation: 'å¯¹äºå®åºåˆ—ï¼ŒDTFTå…·æœ‰å…±è½­å¯¹ç§°æ€§ï¼ˆHermitianå¯¹ç§°æ€§ï¼‰ã€‚è¿™æ„å‘³ç€å¹…åº¦è°±æ˜¯å¶å‡½æ•° $|X(e^{j\\omega})| = |X(e^{-j\\omega})|$ï¼Œç›¸ä½è°±æ˜¯å¥‡å‡½æ•° $\\angle X(e^{j\\omega}) = -\\angle X(e^{-j\\omega})$ã€‚'
            },
            {
                id: 3,
                category: 'dtft',
                categoryName: 'DTFT',
                question: 'DTFTçš„æ—¶ç§»æ€§è´¨ï¼šå¦‚æœ $x[n] \\xrightarrow{\\text{DTFT}} X(e^{j\\omega})$ï¼Œåˆ™ $x[n-n_0]$ çš„DTFTæ˜¯ï¼Ÿ',
                options: [
                    '$e^{j\\omega n_0} X(e^{j\\omega})$',
                    '$e^{-j\\omega n_0} X(e^{j\\omega})$',
                    '$X(e^{j(\\omega - n_0)})$',
                    '$n_0 X(e^{j\\omega})$'
                ],
                correct: 1,
                explanation: 'æ—¶ç§»æ€§è´¨ï¼š$x[n-n_0] \\xrightarrow{\\text{DTFT}} e^{-j\\omega n_0} X(e^{j\\omega})$ã€‚æ—¶åŸŸçš„å»¶æ—¶å¯¹åº”é¢‘åŸŸçš„çº¿æ€§ç›¸ç§»ã€‚'
            },
            {
                id: 4,
                category: 'dtft',
                categoryName: 'DTFT',
                question: 'ç†æƒ³ä½é€šæ»¤æ³¢å™¨çš„é¢‘ç‡å“åº”ä¸º $H(e^{j\\omega}) = \\begin{cases} 1, & |\\omega| < \\omega_c \\\\ 0, & \\omega_c < |\\omega| \\leq \\pi \\end{cases}$ï¼Œå…¶å•ä½è„‰å†²å“åº” $h[n]$ çš„ç‰¹ç‚¹æ˜¯ï¼Ÿ',
                options: [
                    'FIRï¼ˆæœ‰é™é•¿ï¼‰',
                    'IIRï¼ˆæ— é™é•¿ï¼‰',
                    'å› æœçš„',
                    'åªæœ‰æœ‰é™ä¸ªéé›¶å€¼'
                ],
                correct: 1,
                explanation: 'ç†æƒ³ä½é€šæ»¤æ³¢å™¨çš„å•ä½è„‰å†²å“åº”ä¸º $h[n] = \\frac{\\sin(\\omega_c n)}{\\pi n}$ï¼Œè¿™æ˜¯ä¸€ä¸ªæ— é™é•¿åºåˆ—ï¼ˆIIRï¼‰ï¼Œä¸”æ˜¯éå› æœçš„ã€‚å®é™…ç³»ç»Ÿä¸­éœ€è¦è¿‘ä¼¼å®ç°ã€‚'
            },
            {
                id: 5,
                category: 'dtft',
                categoryName: 'DTFT',
                question: 'å·ç§¯å®šç†ï¼šå¦‚æœ $y[n] = x[n] * h[n]$ï¼ˆå·ç§¯ï¼‰ï¼Œåˆ™åœ¨é¢‘åŸŸä¸­ $Y(e^{j\\omega})$ ç­‰äºï¼Ÿ',
                options: [
                    '$X(e^{j\\omega}) + H(e^{j\\omega})$',
                    '$X(e^{j\\omega}) \\cdot H(e^{j\\omega})$',
                    '$X(e^{j\\omega}) * H(e^{j\\omega})$',
                    '$X(e^{j\\omega}) / H(e^{j\\omega})$'
                ],
                correct: 1,
                explanation: 'DTFTçš„å·ç§¯å®šç†ï¼šæ—¶åŸŸå·ç§¯å¯¹åº”é¢‘åŸŸç›¸ä¹˜ã€‚å³ $y[n] = x[n] * h[n] \\xrightarrow{\\text{DTFT}} Y(e^{j\\omega}) = X(e^{j\\omega}) \\cdot H(e^{j\\omega})$ã€‚è¿™æ˜¯é¢‘åŸŸåˆ†æçš„é‡è¦åŸºç¡€ã€‚'
            },
            {
                id: 6,
                category: 'dfs',
                categoryName: 'DFS',
                question: 'ç¦»æ•£å‚…é‡Œå¶çº§æ•°(DFS)é€‚ç”¨äºä»€ä¹ˆç±»å‹çš„ä¿¡å·ï¼Ÿ',
                options: [
                    'ä»»æ„ç¦»æ•£ä¿¡å·',
                    'å‘¨æœŸç¦»æ•£ä¿¡å·',
                    'èƒ½é‡æœ‰é™ä¿¡å·',
                    'å› æœä¿¡å·'
                ],
                correct: 1,
                explanation: 'DFSä¸“é—¨ç”¨äºåˆ†æå‘¨æœŸç¦»æ•£ä¿¡å·ã€‚å¯¹äºå‘¨æœŸä¸ºNçš„ä¿¡å· $\\tilde{x}[n]$ï¼ŒDFSå°†å…¶è¡¨ç¤ºä¸ºNä¸ªå¤æŒ‡æ•°ä¿¡å·çš„çº¿æ€§ç»„åˆï¼š$\\tilde{x}[n] = \\sum_{k=0}^{N-1} X[k] e^{j(2\\pi/N)kn}$ã€‚'
            },
            {
                id: 7,
                category: 'dfs',
                categoryName: 'DFS',
                question: 'å¯¹äºå‘¨æœŸä¸ºNçš„ä¿¡å·ï¼Œå…¶DFSç³»æ•° $X[k]$ çš„å‘¨æœŸæ˜¯ï¼Ÿ',
                options: [
                    '$N/2$',
                    '$N$',
                    '$2N$',
                    'éå‘¨æœŸ'
                ],
                correct: 1,
                explanation: 'DFSç³»æ•° $X[k]$ ä¹Ÿæ˜¯å‘¨æœŸçš„ï¼Œå‘¨æœŸä¸åŸä¿¡å·ç›¸åŒï¼Œéƒ½æ˜¯Nã€‚å³ $X[k+N] = X[k]$ã€‚è¿™æ˜¯DFSçš„å¯¹å¶æ€§è´¨ä¹‹ä¸€ã€‚'
            },
            {
                id: 8,
                category: 'dfs',
                categoryName: 'DFS',
                question: 'DFSçš„åˆ†æå…¬å¼ï¼ˆä»ä¿¡å·æ±‚ç³»æ•°ï¼‰æ˜¯ï¼Ÿ',
                options: [
                    '$X[k] = \\sum_{n=0}^{N-1} \\tilde{x}[n] e^{j(2\\pi/N)kn}$',
                    '$X[k] = \\sum_{n=0}^{N-1} \\tilde{x}[n] e^{-j(2\\pi/N)kn}$',
                    '$X[k] = \\frac{1}{N}\\sum_{n=0}^{N-1} \\tilde{x}[n] e^{-j(2\\pi/N)kn}$',
                    '$X[k] = \\sum_{n=-\\infty}^{\\infty} \\tilde{x}[n] e^{-j(2\\pi/N)kn}$'
                ],
                correct: 2,
                explanation: 'DFSåˆ†æå…¬å¼ï¼ˆæ­£å˜æ¢ï¼‰ï¼š$X[k] = \\frac{1}{N}\\sum_{n=0}^{N-1} \\tilde{x}[n] e^{-j(2\\pi/N)kn}$ï¼Œå…¶ä¸­ $1/N$ æ˜¯å½’ä¸€åŒ–å› å­ï¼Œ$k = 0, 1, ..., N-1$ã€‚'
            },
            {
                id: 9,
                category: 'dfs',
                categoryName: 'DFS',
                question: 'DFSä¸DTFTçš„å…³ç³»æ˜¯ï¼Ÿ',
                options: [
                    'DFSæ˜¯DTFTçš„å‘¨æœŸå»¶æ‹“',
                    'DTFTæ˜¯DFSçš„å‘¨æœŸå»¶æ‹“',
                    'DFSæ˜¯DTFTåœ¨ $\\omega = 2\\pi k/N$ å¤„çš„é‡‡æ ·',
                    'ä¸¤è€…æ²¡æœ‰å…³ç³»'
                ],
                correct: 2,
                explanation: 'å¯¹äºå‘¨æœŸä¿¡å·çš„ä¸€ä¸ªå‘¨æœŸï¼ŒDFSç³»æ•° $X[k]$ æ˜¯è¯¥å‘¨æœŸä¿¡å·DTFTåœ¨é¢‘ç‡ $\\omega_k = 2\\pi k/N$ å¤„çš„é‡‡æ ·å€¼ï¼ˆä¹˜ä»¥å½’ä¸€åŒ–å› å­ï¼‰ã€‚å³ $X[k] = \\frac{1}{N} X(e^{j2\\pi k/N})$ã€‚'
            },
            {
                id: 10,
                category: 'ztransform',
                categoryName: 'Zå˜æ¢',
                question: 'Zå˜æ¢çš„å®šä¹‰å¼æ˜¯ï¼Ÿ',
                options: [
                    '$X(z) = \\sum_{n=0}^{\\infty} x[n]z^{-n}$',
                    '$X(z) = \\sum_{n=-\\infty}^{\\infty} x[n]z^{-n}$',
                    '$X(z) = \\sum_{n=-\\infty}^{\\infty} x[n]e^{-zn}$',
                    '$X(z) = \\int_{-\\infty}^{\\infty} x[n]z^{-n}dn$'
                ],
                correct: 1,
                explanation: 'Zå˜æ¢çš„åŒè¾¹å®šä¹‰ï¼š$X(z) = \\sum_{n=-\\infty}^{\\infty} x[n]z^{-n}$ã€‚å¯¹äºå› æœåºåˆ—ï¼ˆ$n<0$æ—¶$x[n]=0$ï¼‰ï¼Œå¯ä»¥ç®€åŒ–ä¸ºå•è¾¹å½¢å¼ã€‚'
            },
            {
                id: 11,
                category: 'ztransform',
                categoryName: 'Zå˜æ¢',
                question: 'DTFTä¸Zå˜æ¢çš„å…³ç³»æ˜¯ï¼Ÿ',
                options: [
                    'DTFTæ˜¯Zå˜æ¢åœ¨å•ä½åœ†ä¸Šçš„å–å€¼',
                    'Zå˜æ¢æ˜¯DTFTçš„æ¨å¹¿',
                    'ä¸¤è€…ç­‰ä»·',
                    'ä»¥ä¸Šéƒ½å¯¹'
                ],
                correct: 3,
                explanation: 'DTFTå’ŒZå˜æ¢å¯†åˆ‡ç›¸å…³ï¼š(1) DTFTæ˜¯Zå˜æ¢åœ¨å•ä½åœ† $z=e^{j\\omega}$ ä¸Šçš„å–å€¼ï¼›(2) Zå˜æ¢å°†DTFTæ¨å¹¿åˆ°å¤å¹³é¢ï¼›(3) å½“æ”¶æ•›åŸŸåŒ…å«å•ä½åœ†æ—¶ï¼ŒDTFTå­˜åœ¨ä¸”ç­‰äº $X(e^{j\\omega})$ã€‚å› æ­¤ä¸‰ä¸ªè¯´æ³•éƒ½æ­£ç¡®ã€‚'
            },
            {
                id: 12,
                category: 'ztransform',
                categoryName: 'Zå˜æ¢',
                question: 'åºåˆ— $x[n] = a^n u[n]$ çš„Zå˜æ¢åŠå…¶æ”¶æ•›åŸŸ(ROC)æ˜¯ï¼Ÿ',
                options: [
                    '$X(z) = \\frac{1}{1-az^{-1}}$, ROC: $|z| > |a|$',
                    '$X(z) = \\frac{1}{1-az^{-1}}$, ROC: $|z| < |a|$',
                    '$X(z) = \\frac{z}{z-a}$, ROC: $|z| < |a|$',
                    '$X(z) = \\frac{a}{1-z^{-1}}$, ROC: $|z| > 1$'
                ],
                correct: 0,
                explanation: 'å¯¹äºå³è¾¹åºåˆ— $a^n u[n]$ï¼š$X(z) = \\sum_{n=0}^{\\infty} a^n z^{-n} = \\sum_{n=0}^{\\infty} (az^{-1})^n = \\frac{1}{1-az^{-1}}$ï¼Œæ”¶æ•›æ¡ä»¶ä¸º $|az^{-1}| < 1$ï¼Œå³ $|z| > |a|$ã€‚'
            },
            {
                id: 13,
                category: 'ztransform',
                categoryName: 'Zå˜æ¢',
                question: 'Zå˜æ¢çš„æ—¶ç§»æ€§è´¨ï¼šå¦‚æœ $x[n] \\xrightarrow{\\mathcal{Z}} X(z)$ï¼Œåˆ™ $x[n-n_0]$ çš„Zå˜æ¢æ˜¯ï¼Ÿ',
                options: [
                    '$z^{n_0} X(z)$',
                    '$z^{-n_0} X(z)$',
                    '$e^{-jn_0} X(z)$',
                    '$X(z-n_0)$'
                ],
                correct: 1,
                explanation: 'Zå˜æ¢çš„æ—¶ç§»æ€§è´¨ï¼š$x[n-n_0] \\xrightarrow{\\mathcal{Z}} z^{-n_0} X(z)$ã€‚æ—¶åŸŸå»¶æ—¶ $n_0$ å¯¹åº”zåŸŸä¹˜ä»¥ $z^{-n_0}$ã€‚è¿™æ˜¯æ±‚è§£å·®åˆ†æ–¹ç¨‹çš„å…³é”®æ€§è´¨ã€‚'
            },
            {
                id: 14,
                category: 'ztransform',
                categoryName: 'Zå˜æ¢',
                question: 'å·²çŸ¥ç³»ç»Ÿå‡½æ•° $H(z) = \\frac{1-0.5z^{-1}}{1-0.8z^{-1}}$ï¼Œç³»ç»Ÿçš„é›¶ç‚¹å’Œæç‚¹åˆ†åˆ«æ˜¯ï¼Ÿ',
                options: [
                    'é›¶ç‚¹ï¼š$z=0.5$ï¼›æç‚¹ï¼š$z=0.8$',
                    'é›¶ç‚¹ï¼š$z=0.8$ï¼›æç‚¹ï¼š$z=0.5$',
                    'é›¶ç‚¹ï¼š$z=2$ï¼›æç‚¹ï¼š$z=1.25$',
                    'é›¶ç‚¹ï¼š$z=-0.5$ï¼›æç‚¹ï¼š$z=-0.8$'
                ],
                correct: 0,
                explanation: 'é›¶ç‚¹æ˜¯ä½¿åˆ†å­ä¸º0çš„zå€¼ï¼š$1-0.5z^{-1}=0 \\Rightarrow z=0.5$ã€‚æç‚¹æ˜¯ä½¿åˆ†æ¯ä¸º0çš„zå€¼ï¼š$1-0.8z^{-1}=0 \\Rightarrow z=0.8$ã€‚æ³¨æ„é›¶æç‚¹éƒ½åœ¨å•ä½åœ†å†…ï¼Œç³»ç»Ÿç¨³å®šã€‚'
            },
            {
                id: 15,
                category: 'ztransform',
                categoryName: 'Zå˜æ¢',
                question: 'éƒ¨åˆ†åˆ†å¼å±•å¼€æ³•ä¸»è¦ç”¨äºæ±‚è§£Zå˜æ¢çš„å“ªä¸ªé—®é¢˜ï¼Ÿ',
                options: [
                    'æ­£å˜æ¢',
                    'é€†å˜æ¢',
                    'æ”¶æ•›åŸŸ',
                    'é›¶æç‚¹'
                ],
                correct: 1,
                explanation: 'éƒ¨åˆ†åˆ†å¼å±•å¼€æ˜¯é€†Zå˜æ¢çš„é‡è¦æ–¹æ³•ã€‚å°†æœ‰ç†åˆ†å¼ $X(z)$ å±•å¼€ä¸ºç®€å•åˆ†å¼ä¹‹å’Œï¼Œç„¶åæŸ¥è¡¨å¾—åˆ°æ¯ä¸€é¡¹å¯¹åº”çš„æ—¶åŸŸåºåˆ—ï¼Œæœ€åæ±‚å’Œå¾—åˆ° $x[n]$ã€‚'
            },
            {
                id: 16,
                category: 'system',
                categoryName: 'ç³»ç»Ÿåˆ†æ',
                question: 'å› æœç¨³å®šçš„LTIç³»ç»Ÿï¼Œå…¶ç³»ç»Ÿå‡½æ•° $H(z)$ çš„æç‚¹ä½ç½®å¿…é¡»æ»¡è¶³ï¼Ÿ',
                options: [
                    'åœ¨å•ä½åœ†å¤–',
                    'åœ¨å•ä½åœ†ä¸Š',
                    'åœ¨å•ä½åœ†å†…',
                    'åœ¨å³åŠå¹³é¢'
                ],
                correct: 2,
                explanation: 'å› æœç¨³å®šç³»ç»Ÿçš„å……è¦æ¡ä»¶æ˜¯ï¼šæ‰€æœ‰æç‚¹åœ¨å•ä½åœ†å†…ï¼Œå³ $|p_i| < 1$ã€‚å¦‚æœæç‚¹åœ¨å•ä½åœ†ä¸Šæˆ–åœ†å¤–ï¼Œç³»ç»Ÿè¾“å‡ºä¼šå‡ºç°æŒç»­æŒ¯è¡æˆ–å‘æ•£ï¼Œä¸ç¨³å®šã€‚'
            },
            {
                id: 17,
                category: 'system',
                categoryName: 'ç³»ç»Ÿåˆ†æ',
                question: 'å·®åˆ†æ–¹ç¨‹ $y[n] - 0.5y[n-1] = x[n]$ å¯¹åº”çš„ç³»ç»Ÿå‡½æ•° $H(z)$ æ˜¯ï¼Ÿ',
                options: [
                    '$H(z) = 1 - 0.5z^{-1}$',
                    '$H(z) = \\frac{1}{1-0.5z^{-1}}$',
                    '$H(z) = 0.5z^{-1}$',
                    '$H(z) = \\frac{0.5}{1-z^{-1}}$'
                ],
                correct: 1,
                explanation: 'å¯¹å·®åˆ†æ–¹ç¨‹ä¸¤è¾¹å–Zå˜æ¢ï¼š$Y(z) - 0.5z^{-1}Y(z) = X(z)$ï¼Œæ•´ç†å¾— $Y(z)[1-0.5z^{-1}] = X(z)$ï¼Œæ‰€ä»¥ $H(z) = \\frac{Y(z)}{X(z)} = \\frac{1}{1-0.5z^{-1}}$ã€‚'
            },
            {
                id: 18,
                category: 'system',
                categoryName: 'ç³»ç»Ÿåˆ†æ',
                question: 'FIRï¼ˆæœ‰é™è„‰å†²å“åº”ï¼‰æ»¤æ³¢å™¨çš„ç³»ç»Ÿå‡½æ•° $H(z)$ çš„ç‰¹ç‚¹æ˜¯ï¼Ÿ',
                options: [
                    'åªæœ‰æç‚¹ï¼Œæ— é›¶ç‚¹',
                    'åªæœ‰é›¶ç‚¹ï¼Œæ— æœ‰é™æç‚¹',
                    'æ—¢æœ‰é›¶ç‚¹åˆæœ‰æç‚¹',
                    'æ—¢æ— é›¶ç‚¹ä¹Ÿæ— æç‚¹'
                ],
                correct: 1,
                explanation: 'FIRæ»¤æ³¢å™¨çš„ç³»ç»Ÿå‡½æ•°å½¢å¼ä¸º $H(z) = \\sum_{n=0}^{M} b_n z^{-n}$ï¼Œè¿™æ˜¯ä¸€ä¸ªå¤šé¡¹å¼ï¼Œåªæœ‰é›¶ç‚¹ï¼Œæ‰€æœ‰æç‚¹éƒ½åœ¨åŸç‚¹ $z=0$ï¼ˆæ— æœ‰é™æç‚¹ï¼‰ã€‚FIRç³»ç»Ÿæ€»æ˜¯ç¨³å®šçš„ã€‚'
            },
            {
                id: 19,
                category: 'system',
                categoryName: 'ç³»ç»Ÿåˆ†æ',
                question: 'ä¸€ä¸ªç³»ç»Ÿçš„æç‚¹ä½äº $z=0.9e^{j\\pi/4}$ å’Œ $z=0.9e^{-j\\pi/4}$ï¼Œè¯¥ç³»ç»Ÿçš„é¢‘ç‡å“åº”åœ¨å“ªä¸ªé¢‘ç‡é™„è¿‘ä¼šæœ‰å³°å€¼ï¼Ÿ',
                options: [
                    '$\\omega = 0$',
                    '$\\omega = \\pi/4$',
                    '$\\omega = \\pi/2$',
                    '$\\omega = \\pi$'
                ],
                correct: 1,
                explanation: 'æç‚¹ä½ç½®å†³å®šé¢‘ç‡å“åº”çš„å³°å€¼ä½ç½®ã€‚æç‚¹ $z=0.9e^{j\\pi/4}$ åœ¨å•ä½åœ†å†…ï¼Œä¸å•ä½åœ†ä¸Š $\\omega=\\pi/4$ çš„ç‚¹è·ç¦»æœ€è¿‘ï¼Œå› æ­¤é¢‘ç‡å“åº”åœ¨ $\\omega=\\pi/4$ é™„è¿‘è¾¾åˆ°å³°å€¼ã€‚è¿™æ˜¯è°æŒ¯ç°è±¡ã€‚'
            },
            {
                id: 20,
                category: 'system',
                categoryName: 'ç³»ç»Ÿåˆ†æ',
                question: 'é›¶ç‚¹ä½äºå•ä½åœ†ä¸ŠæŸé¢‘ç‡ $\\omega_0$ å¤„ï¼Œåˆ™ç³»ç»Ÿåœ¨è¯¥é¢‘ç‡çš„å“åº”æ˜¯ï¼Ÿ',
                options: [
                    'è¾¾åˆ°æœ€å¤§å€¼',
                    'ä¸ºé›¶ï¼ˆå®Œå…¨è¡°å‡ï¼‰',
                    'ä¸ºä¸­é—´å€¼',
                    'ä¸ç¡®å®š'
                ],
                correct: 1,
                explanation: 'é›¶ç‚¹ä½¿å…¶æ‰€åœ¨é¢‘ç‡çš„å“åº”ä¸ºé›¶ã€‚å½“é›¶ç‚¹ä½äºå•ä½åœ†ä¸Š $z=e^{j\\omega_0}$ æ—¶ï¼Œè¯¥é¢‘ç‡çš„å“åº” $H(e^{j\\omega_0})=0$ï¼Œå½¢æˆé™·æ³¢æ•ˆæœã€‚è¿™æ˜¯è®¾è®¡é™·æ³¢æ»¤æ³¢å™¨çš„åŸºæœ¬åŸç†ã€‚'
            }
        ];

        let questions = [];
        let currentQuestion = 0;
        let userAnswers = new Array(20).fill(null);
        let submitted = false;
        let studentInfo = { id: '', name: '' };

        // éšæœºæ‰“ä¹±æ•°ç»„
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // æ‰“ä¹±é¢˜ç›®é€‰é¡¹
        function shuffleQuestions() {
            questions = originalQuestions.map(q => {
                // åˆ›å»ºé€‰é¡¹å’Œç´¢å¼•çš„æ˜ å°„
                const optionsWithIndex = q.options.map((option, index) => ({
                    text: option,
                    originalIndex: index
                }));
                
                // æ‰“ä¹±é€‰é¡¹
                const shuffledOptions = shuffleArray(optionsWithIndex);
                
                // æ‰¾åˆ°æ­£ç¡®ç­”æ¡ˆåœ¨æ–°é¡ºåºä¸­çš„ä½ç½®
                const newCorrectIndex = shuffledOptions.findIndex(
                    opt => opt.originalIndex === q.correct
                );
                
                return {
                    ...q,
                    options: shuffledOptions.map(opt => opt.text),
                    correct: newCorrectIndex
                };
            });
        }

        // å¼€å§‹è€ƒè¯•
        function startExam() {
            const studentId = document.getElementById('studentId').value.trim();
            const studentName = document.getElementById('studentName').value.trim();
            
            if (!studentId || !studentName) {
                alert('è¯·å¡«å†™å®Œæ•´çš„å­¦å·å’Œå§“åï¼');
                return;
            }
            
            studentInfo.id = studentId;
            studentInfo.name = studentName;
            
            // æ‰“ä¹±é¢˜ç›®é€‰é¡¹
            shuffleQuestions();
            
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('examScreen').style.display = 'block';
            
            init();
        }

        // åˆå§‹åŒ–
        function init() {
            displayQuestion();
            updateButtons();
            updateProgress();
        }

        // æ˜¾ç¤ºé¢˜ç›®
        function displayQuestion() {
            const q = questions[currentQuestion];
            const container = document.getElementById('questionContainer');
            
            let html = `
                <div class="question-card ${userAnswers[currentQuestion] !== null ? 'answered' : ''}">
                    <div class="question-header">
                        <span class="question-number">ç¬¬ ${q.id} é¢˜</span>
                        <span class="question-category ${q.category}">${q.categoryName}</span>
                    </div>
                    <div class="question-text">${q.question}</div>
                    <div class="options">
            `;

            q.options.forEach((option, index) => {
                const selected = userAnswers[currentQuestion] === index ? 'selected' : '';
                const label = String.fromCharCode(65 + index); // A, B, C, D
                html += `
                    <div class="option ${selected}" onclick="selectOption(${index})">
                        <div class="option-label">${label}</div>
                        <div class="option-text">${option}</div>
                    </div>
                `;
            });

            html += `
                    </div>
                    <div class="explanation" id="explanation"></div>
                </div>
            `;

            container.innerHTML = html;
            
            // æ¸²æŸ“æ•°å­¦å…¬å¼
            if (window.MathJax) {
                MathJax.typesetPromise([container]).catch((err) => console.log(err));
            }
        }

        // é€‰æ‹©é€‰é¡¹
        function selectOption(index) {
            if (submitted) return;
            userAnswers[currentQuestion] = index;
            displayQuestion();
            updateProgress();
        }

        // æäº¤ç­”æ¡ˆ
        function submitAnswer() {
            if (userAnswers[currentQuestion] === null) {
                alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªç­”æ¡ˆï¼');
                return;
            }

            const q = questions[currentQuestion];
            const userAnswer = userAnswers[currentQuestion];
            const isCorrect = userAnswer === q.correct;

            // æ˜¾ç¤ºç»“æœ
            const options = document.querySelectorAll('.option');
            options.forEach((option, index) => {
                if (index === q.correct) {
                    option.classList.add('correct');
                } else if (index === userAnswer && !isCorrect) {
                    option.classList.add('incorrect');
                }
                option.style.pointerEvents = 'none';
            });

            // æ˜¾ç¤ºè§£æ
            const explanation = document.getElementById('explanation');
            const icon = isCorrect ? 'âœ“' : 'âœ—';
            const style = isCorrect ? 'color: #28a745;' : 'color: #dc3545;';
            explanation.innerHTML = `
                <h4><span style="${style}">${icon}</span> ${isCorrect ? 'å›ç­”æ­£ç¡®ï¼' : 'å›ç­”é”™è¯¯ï¼'}</h4>
                <p><strong>æ­£ç¡®ç­”æ¡ˆï¼š</strong>${String.fromCharCode(65 + q.correct)}</p>
                <p><strong>è§£æï¼š</strong>${q.explanation}</p>
            `;
            explanation.classList.add('show');

            // æ¸²æŸ“è§£æä¸­çš„æ•°å­¦å…¬å¼
            if (window.MathJax) {
                MathJax.typesetPromise([explanation]).catch((err) => console.log(err));
            }

            // æ›´æ–°æŒ‰é’®
            document.getElementById('submitBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'inline-block';
            if (currentQuestion === questions.length - 1) {
                document.getElementById('finishBtn').style.display = 'inline-block';
                document.getElementById('nextBtn').style.display = 'none';
            }
        }

        // ä¸‹ä¸€é¢˜
        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                displayQuestion();
                updateButtons();
                window.scrollTo(0, 0);
            }
        }

        // ä¸Šä¸€é¢˜
        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                displayQuestion();
                updateButtons();
                window.scrollTo(0, 0);
            }
        }

        // æ›´æ–°æŒ‰é’®çŠ¶æ€
        function updateButtons() {
            document.getElementById('prevBtn').disabled = currentQuestion === 0;
            document.getElementById('submitBtn').style.display = 'inline-block';
            document.getElementById('nextBtn').style.display = 'none';
            document.getElementById('finishBtn').style.display = 'none';
        }

        // æ›´æ–°è¿›åº¦
        function updateProgress() {
            const answered = userAnswers.filter(a => a !== null).length;
            const progressBar = document.getElementById('progressBar');
            const percentage = (answered / questions.length) * 100;
            progressBar.style.width = percentage + '%';
            progressBar.textContent = `${answered}/${questions.length} å·²å®Œæˆ`;
        }

        // å®Œæˆè€ƒè¯•
        function finishExam() {
            if (userAnswers.includes(null)) {
                const unanswered = userAnswers.filter(a => a === null).length;
                if (!confirm(`è¿˜æœ‰ ${unanswered} é¢˜æœªä½œç­”ï¼Œç¡®å®šè¦æäº¤å—ï¼Ÿ`)) {
                    return;
                }
            }

            submitted = true;
            calculateResults();
            document.getElementById('examScreen').style.display = 'none';
            document.getElementById('resultPanel').classList.add('show');
        }

        // è®¡ç®—ç»“æœ
        function calculateResults() {
            let correctCount = 0;
            let categoryScores = {
                dtft: { correct: 0, total: 0 },
                dfs: { correct: 0, total: 0 },
                ztransform: { correct: 0, total: 0 },
                system: { correct: 0, total: 0 }
            };

            questions.forEach((q, index) => {
                const isCorrect = userAnswers[index] === q.correct;
                if (isCorrect) correctCount++;

                categoryScores[q.category].total++;
                if (isCorrect) categoryScores[q.category].correct++;
            });

            const percentage = (correctCount / questions.length * 100).toFixed(1);

            // æ˜¾ç¤ºå­¦ç”Ÿä¿¡æ¯
            document.getElementById('resultStudentId').textContent = studentInfo.id;
            document.getElementById('resultStudentName').textContent = studentInfo.name;

            // æ˜¾ç¤ºæ€»åˆ†
            document.getElementById('resultScore').textContent = `${correctCount}/${questions.length}`;
            document.getElementById('accuracyRate').textContent = percentage + '%';

            // è¯„ä»·
            let message = '';
            if (percentage >= 90) {
                message = 'ğŸ‰ ä¼˜ç§€ï¼ä½ å¯¹è¿™éƒ¨åˆ†çŸ¥è¯†æŒæ¡å¾—éå¸¸å¥½ï¼';
            } else if (percentage >= 80) {
                message = 'ğŸ‘ è‰¯å¥½ï¼ç»§ç»­ä¿æŒï¼Œç¨åŠ å·©å›ºå°±èƒ½æ›´å¥½ï¼';
            } else if (percentage >= 70) {
                message = 'âœ“ åŠæ ¼ï¼åŸºç¡€è¿˜å¯ä»¥ï¼Œéœ€è¦åŠ å¼ºç»ƒä¹ ï¼';
            } else if (percentage >= 60) {
                message = 'âš ï¸ åˆšåŠæ ¼ï¼Œå»ºè®®å¤ä¹ é‡ç‚¹çŸ¥è¯†ç‚¹ï¼';
            } else {
                message = 'âŒ éœ€è¦åŠªåŠ›ï¼è¯·è®¤çœŸå¤ä¹ è¯¾ç¨‹å†…å®¹ï¼';
            }
            document.getElementById('resultMessage').textContent = message;

            // åˆ†ç±»ç»Ÿè®¡
            document.getElementById('dtftScore').textContent = 
                `${categoryScores.dtft.correct}/${categoryScores.dtft.total}`;
            document.getElementById('dfsScore').textContent = 
                `${categoryScores.dfs.correct}/${categoryScores.dfs.total}`;
            document.getElementById('ztScore').textContent = 
                `${categoryScores.ztransform.correct}/${categoryScores.ztransform.total}`;
            document.getElementById('systemScore').textContent = 
                `${categoryScores.system.correct}/${categoryScores.system.total}`;
        }

        // æ˜¾ç¤ºè¯¦ç»†å›é¡¾
        function showReview() {
            const reviewSection = document.getElementById('reviewSection');
            const reviewContainer = document.getElementById('reviewContainer');
            
            let html = '';
            questions.forEach((q, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer === q.correct;
                const statusClass = isCorrect ? 'correct' : 'wrong';
                const statusText = isCorrect ? 'âœ“ æ­£ç¡®' : 'âœ— é”™è¯¯';
                
                html += `
                    <div class="review-question">
                        <div class="review-header">
                            <div>
                                <span class="question-number">ç¬¬ ${q.id} é¢˜</span>
                                <span class="question-category ${q.category}">${q.categoryName}</span>
                            </div>
                            <span class="review-status ${statusClass}">${statusText}</span>
                        </div>
                        <div class="question-text">${q.question}</div>
                        <div style="margin-top: 15px;">
                            <p><strong>ä½ çš„ç­”æ¡ˆï¼š</strong>${userAnswer !== null ? String.fromCharCode(65 + userAnswer) + '. ' + q.options[userAnswer] : 'æœªä½œç­”'}</p>
                            <p style="color: #28a745;"><strong>æ­£ç¡®ç­”æ¡ˆï¼š</strong>${String.fromCharCode(65 + q.correct)}. ${q.options[q.correct]}</p>
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin-top: 15px;">
                            <strong>ğŸ“– è§£æï¼š</strong>${q.explanation}
                        </div>
                    </div>
                `;
            });

            reviewContainer.innerHTML = html;
            reviewSection.style.display = 'block';

            // æ¸²æŸ“æ•°å­¦å…¬å¼
            if (window.MathJax) {
                MathJax.typesetPromise([reviewContainer]).catch((err) => console.log(err));
            }

            // æ»šåŠ¨åˆ°å›é¡¾åŒºåŸŸ
            reviewSection.scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>
