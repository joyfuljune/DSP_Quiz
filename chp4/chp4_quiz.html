<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DFT/FFTä¸“é¡¹æµ‹éªŒ</title>
    
    <!-- ä½¿ç”¨ç¨³å®šå¯é çš„å®˜æ–¹CDNåŠ è½½MathJaxè„šæœ¬ -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2em;
        }

        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        /* å¼€å§‹ç•Œé¢æ ·å¼ */
        .start-screen {
            text-align: center;
            padding: 20px;
        }

        .info-form {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 30px;
            margin: 30px 0;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            color: #2c3e50;
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #3498db;
        }

        .exam-info {
            background: #e8f4f8;
            border-left: 4px solid #3498db;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        .exam-info h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .exam-info ul {
            margin-left: 20px;
            color: #34495e;
            line-height: 1.8;
        }

        .progress-bar {
            background: #ecf0f1;
            height: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            background: linear-gradient(90deg, #3498db, #2ecc71);
            height: 100%;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .question-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px solid #dee2e6;
            transition: all 0.3s;
        }

        .question-card.answered {
            border-color: #3498db;
            background: #e8f4f8;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .question-number {
            background: #3498db;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .question-category {
            background: #95a5a6;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85em;
        }
        
        .question-category.dft_basic { background: #e74c3c; }
        .question-category.dft_props { background: #f39c12; }
        .question-category.fft_algo { background: #27ae60; }
        .question-category.fft_app { background: #8e44ad; }


        .question-text {
            font-size: 1.1em;
            color: #2c3e50;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .option:hover {
            background: #f8f9fa;
            border-color: #3498db;
            transform: translateX(5px);
        }

        .option.selected {
            background: #e8f4f8;
            border-color: #3498db;
            border-width: 3px;
        }

        .option.correct {
            background: #d4edda;
            border-color: #28a745;
            border-width: 3px;
        }

        .option.incorrect {
            background: #f8d7da;
            border-color: #dc3545;
            border-width: 3px;
        }

        .option-label {
            background: #3498db;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .option.correct .option-label { background: #28a745; }
        .option.incorrect .option-label { background: #dc3545; }
        .option-text { flex: 1; color: #2c3e50; }

        .explanation {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            display: none;
        }

        .explanation.show { display: block; animation: slideDown 0.3s ease; }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .explanation h4 {
            color: #856404;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .explanation p { color: #856404; line-height: 1.6; }

        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        button {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-submit { background: #3498db; color: white; }
        .btn-next { background: #2ecc71; color: white; }
        .btn-prev { background: #95a5a6; color: white; }
        .btn-finish { background: #e74c3c; color: white; }
        .btn-start { background: #3498db; color: white; padding: 15px 50px; font-size: 1.2em; }

        .result-panel {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            display: none;
        }

        .result-panel.show { display: block; animation: fadeIn 0.5s ease; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .student-info {
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            font-size: 1.2em;
        }

        .student-info p { margin: 5px 0; }
        .result-score { font-size: 4em; font-weight: bold; margin: 20px 0; }
        .result-message { font-size: 1.5em; margin-bottom: 20px; }
        .result-details { background: rgba(255,255,255,0.2); border-radius: 10px; padding: 20px; margin-top: 20px; }
        .result-details table { width: 100%; border-collapse: collapse; }
        .result-details td { padding: 10px; font-size: 1.1em; }
        .review-section { margin-top: 30px; }

        .review-question {
            background: white;
            color: #2c3e50;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ecf0f1;
        }

        .review-status {
            padding: 5px 15px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.9em;
        }
        .review-status.correct { background: #d4edda; color: #155724; }
        .review-status.wrong { background: #f8d7da; color: #721c24; }
        .statistics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            background: white;
            color: #2c3e50;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .stat-value { font-size: 2em; font-weight: bold; margin: 10px 0; }
        .stat-label { color: #7f8c8d; font-size: 0.9em; }

        @media (max-width: 768px) {
            .container { padding: 20px; }
            h1 { font-size: 1.5em; }
            .button-group { flex-direction: column; }
            button { width: 100%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>DFT/FFTä¸“é¡¹æµ‹éªŒ</h1>
        <p class="subtitle">å—äº¬å·¥ä¸šå¤§å­¦æµ¦æ±Ÿå­¦é™¢ | DSP - å¿«é€Ÿå‚…é‡Œå¶å˜æ¢</p>

        <!-- å¼€å§‹ç•Œé¢ -->
        <div id="startScreen" class="start-screen">
            <div class="exam-info">
                <h3>ğŸ“‹ æµ‹éªŒè¯´æ˜</h3>
                <ul>
                    <li>å…±20é“é€‰æ‹©é¢˜ï¼Œæ¶µç›–DFTåŸºç¡€ã€æ€§è´¨ã€FFTç®—æ³•ä¸åº”ç”¨</li>
                    <li>æ¯é¢˜1åˆ†ï¼Œæ€»åˆ†20åˆ†</li>
                    <li>ç‚¹å‡»é€‰é¡¹é€‰æ‹©ç­”æ¡ˆ,å¯ä»¥éšæ—¶ä¿®æ”¹</li>
                    <li>æäº¤åå¯æŸ¥çœ‹è¯¦ç»†è§£æå’Œæ­£ç¡®ç­”æ¡ˆ</li>
                </ul>
            </div>

            <div class="info-form">
                <h3 style="color: #2c3e50; margin-bottom: 20px;">è¯·å¡«å†™ä½ çš„ä¿¡æ¯</h3>
                <div class="form-group">
                    <label for="studentId">å­¦å· <span style="color: red;">*</span></label>
                    <input type="text" id="studentId" placeholder="è¯·è¾“å…¥å­¦å·" required="">
                </div>
                <div class="form-group">
                    <label for="studentName">å§“å <span style="color: red;">*</span></label>
                    <input type="text" id="studentName" placeholder="è¯·è¾“å…¥å§“å" required="">
                </div>
                <button class="btn-start" onclick="startExam()">å¼€å§‹è€ƒè¯•</button>
            </div>
        </div>

        <!-- è€ƒè¯•ç•Œé¢ -->
        <div id="examScreen" style="display: none;">
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar">0/20 å·²å®Œæˆ</div>
            </div>

            <div id="questionContainer"></div>

            <div class="button-group">
                <button class="btn-prev" id="prevBtn" onclick="previousQuestion()">â¬…ï¸ ä¸Šä¸€é¢˜</button>
                <button class="btn-submit" id="submitBtn" onclick="submitAnswer()">âœ“ æäº¤ç­”æ¡ˆ</button>
                <button class="btn-next" id="nextBtn" onclick="nextQuestion()">ä¸‹ä¸€é¢˜ â¡ï¸</button>
                <button class="btn-finish" id="finishBtn" onclick="finishExam()" style="display: none;">ğŸ å®Œæˆè€ƒè¯•</button>
            </div>
        </div>

        <!-- ç»“æœç•Œé¢ -->
        <div class="result-panel" id="resultPanel">
            <h2>è€ƒè¯•å®Œæˆï¼</h2>
            
            <div class="student-info">
                <p><strong>å­¦å·ï¼š</strong><span id="resultStudentId"></span></p>
                <p><strong>å§“åï¼š</strong><span id="resultStudentName"></span></p>
            </div>

            <div class="result-score" id="resultScore">0/20</div>
            <div class="result-message" id="resultMessage"></div>
            
            <div class="statistics">
                <div class="stat-card">
                    <div class="stat-label">æ­£ç¡®ç‡</div>
                    <div class="stat-value" id="accuracyRate">0%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">DFTåŸºç¡€</div>
                    <div class="stat-value" id="dftBasicScore">0/5</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">DFTæ€§è´¨</div>
                    <div class="stat-value" id="dftPropsScore">0/5</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">FFTç®—æ³•</div>
                    <div class="stat-value" id="fftAlgoScore">0/6</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">FFTåº”ç”¨</div>
                    <div class="stat-value" id="fftAppScore">0/4</div>
                </div>
            </div>

            <button class="btn-submit" onclick="showReview()" style="margin-top: 30px;">ğŸ“ æŸ¥çœ‹è¯¦ç»†è§£æ</button>
            <button class="btn-next" onclick="location.reload()" style="margin-top: 10px;">ğŸ”„ é‡æ–°å¼€å§‹</button>
        </div>

        <div id="reviewSection" style="display: none;">
            <h2 style="margin: 30px 0 20px 0; color: #2c3e50;">ğŸ“š ç­”é¢˜å›é¡¾ä¸è§£æ</h2>
            <div id="reviewContainer"></div>
        </div>
    </div>

<script>
    const originalQuestions = [
        {
            id: 1,
            category: 'dft_basic',
            categoryName: 'DFTåŸºç¡€',
            question: 'Nç‚¹DFTï¼ˆç¦»æ•£å‚…é‡Œå¶å˜æ¢ï¼‰çš„åˆ†æå…¬å¼æ˜¯ï¼Ÿ',
            options: [
                '$X[k] = \\sum_{n=0}^{N-1} x[n] e^{j \\frac{2\\pi}{N} kn}$',
                '$X[k] = \\frac{1}{N} \\sum_{n=0}^{N-1} x[n] e^{-j \\frac{2\\pi}{N} kn}$',
                '$X[k] = \\sum_{n=0}^{N-1} x[n] e^{-j \\frac{2\\pi}{N} kn}$',
                '$X[k] = \\frac{1}{N} \\sum_{n=0}^{N-1} x[n] e^{j \\frac{2\\pi}{N} kn}$'
            ],
            correct: 2,
            explanation: 'Nç‚¹DFTçš„åˆ†æå…¬å¼ï¼ˆæ­£å˜æ¢ï¼‰ä¸º $X[k] = \\sum_{n=0}^{N-1} x[n] e^{-j \\frac{2\\pi}{N} kn}$ï¼Œå…¶ä¸­ $k=0, 1, ..., N-1$ã€‚æ³¨æ„æŒ‡æ•°é¡¹ä¸ºè´Ÿå·ï¼Œä¸”æ²¡æœ‰ $1/N$ çš„ç³»æ•°ã€‚$1/N$ ç³»æ•°å‡ºç°åœ¨IDFTï¼ˆé€†å˜æ¢ï¼‰ä¸­ã€‚'
        },
        {
            id: 2,
            category: 'fft_algo',
            categoryName: 'FFTç®—æ³•',
            question: 'ç›´æ¥è®¡ç®—Nç‚¹DFTæ‰€éœ€çš„å¤æ•°ä¹˜æ³•æ¬¡æ•°ä¸Nçš„å…³ç³»æ˜¯ä»€ä¹ˆé‡çº§çš„ï¼Ÿè€ŒFFTç®—æ³•å‘¢ï¼Ÿ',
            options: [
                'DFT: $O(N)$, FFT: $O(\\log_2 N)$',
                'DFT: $O(N^2)$, FFT: $O(N \\log_2 N)$',
                'DFT: $O(N \\log_2 N)$, FFT: $O(N^2)$',
                'DFT: $O(N^2)$, FFT: $O(N)$'
            ],
            correct: 1,
            explanation: 'ç›´æ¥è®¡ç®—Nç‚¹DFTéœ€è¦è¿›è¡ŒNæ¬¡æ±‚å’Œï¼Œæ¯æ¬¡æ±‚å’ŒåŒ…å«Nä¸ªå¤æ•°ä¹˜æ³•ï¼Œæ€»å¤æ‚åº¦ä¸º $O(N^2)$ã€‚è€ŒFFTï¼ˆå¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼‰æ˜¯ä¸€ç§é«˜æ•ˆç®—æ³•ï¼Œåˆ©ç”¨æ—‹è½¬å› å­çš„å¯¹ç§°æ€§å’Œå‘¨æœŸæ€§ï¼Œå°†å¤æ‚åº¦é™ä½åˆ° $O(N \\log_2 N)$ï¼Œæå¤§åœ°æé«˜äº†è®¡ç®—æ•ˆç‡ã€‚'
        },
        {
            id: 3,
            category: 'dft_basic',
            categoryName: 'DFTåŸºç¡€',
            question: 'DFTä¸DTFTï¼ˆç¦»æ•£æ—¶é—´å‚…é‡Œå¶å˜æ¢ï¼‰ä¹‹é—´çš„å…³ç³»æ˜¯ï¼Ÿ',
            options: [
                'DFTæ˜¯DTFTåœ¨å•ä½åœ†ä¸Šçš„å‡åŒ€é‡‡æ ·',
                'DTFTæ˜¯DFTçš„å‘¨æœŸå»¶æ‹“',
                'ä¸¤è€…å®Œå…¨ç­‰ä»·',
                'ä¸¤è€…æ²¡æœ‰ç›´æ¥å…³ç³»'
            ],
            correct: 0,
            explanation: 'ä¸€ä¸ªé•¿åº¦ä¸ºNçš„æœ‰é™é•¿åºåˆ—$x[n]$ï¼Œå…¶Nç‚¹DFT $X[k]$ å®è´¨ä¸Šæ˜¯è¯¥åºåˆ—çš„DTFT $X(e^{j\\omega})$ åœ¨é¢‘åŸŸ $[0, 2\\pi]$ åŒºé—´ä¸Šçš„Nä¸ªç­‰é—´éš”ç‚¹çš„é‡‡æ ·å€¼ã€‚å³ $X[k] = X(e^{j\\omega})|_{\\omega = \\frac{2\\pi}{N}k}$ã€‚'
        },
        {
            id: 4,
            category: 'fft_algo',
            categoryName: 'FFTç®—æ³•',
            question: 'åœ¨FFTç®—æ³•ä¸­ï¼Œæ—‹è½¬å› å­ $W_N^k$ å®šä¹‰ä¸º $e^{-j\\frac{2\\pi k}{N}}$ã€‚å®ƒå…·æœ‰å¯¹ç§°æ€§è´¨ï¼Œå³ $W_N^{k+N/2}$ ç­‰äºï¼Ÿ',
            options: [
                '$W_N^k$',
                '$-W_N^k$',
                '$(W_N^k)^*$',
                '$1/W_N^k$'
            ],
            correct: 1,
            explanation: 'åˆ©ç”¨æ¬§æ‹‰å…¬å¼ï¼Œ$W_N^{k+N/2} = e^{-j\\frac{2\\pi}{N}(k+N/2)} = e^{-j\\frac{2\\pi k}{N}} \\cdot e^{-j\\pi} = W_N^k \\cdot (-1) = -W_N^k$ã€‚è¿™ä¸ªæ€§è´¨æ˜¯æ„æˆFFTè¶å½¢è¿ç®—çš„åŸºç¡€ï¼Œä½¿å¾—è¿ç®—å¯ä»¥è¢«åˆ†è§£å’Œç®€åŒ–ã€‚'
        },
        {
            id: 5,
            category: 'fft_algo',
            categoryName: 'FFTç®—æ³•',
            question: 'åŸº-2 DIT-FFTï¼ˆæŒ‰æ—¶é—´æŠ½é€‰çš„FFTï¼‰ç®—æ³•çš„è¾“å…¥å’Œè¾“å‡ºåºåˆ—çš„é¡ºåºæ˜¯ï¼Ÿ',
            options: [
                'è¾“å…¥è‡ªç„¶é¡ºåºï¼Œè¾“å‡ºç ä½å€’åº',
                'è¾“å…¥ç ä½å€’åºï¼Œè¾“å‡ºè‡ªç„¶é¡ºåº',
                'è¾“å…¥å’Œè¾“å‡ºå‡ä¸ºè‡ªç„¶é¡ºåº',
                'è¾“å…¥å’Œè¾“å‡ºå‡ä¸ºç ä½å€’åº'
            ],
            correct: 1,
            explanation: 'DIT-FFTï¼ˆDecimation-In-Timeï¼‰ç®—æ³•é€šè¿‡ä¸æ–­åœ°å°†æ—¶åŸŸåºåˆ—åˆ†è§£ä¸ºå¶æ•°é¡¹å’Œå¥‡æ•°é¡¹æ¥è¿›è¡Œè®¡ç®—ã€‚è¿™ç§åˆ†è§£è¿‡ç¨‹è‡ªç„¶åœ°è¦æ±‚è¾“å…¥åºåˆ—æ˜¯æŒ‰ç ä½å€’ç½®ï¼ˆbit-reversalï¼‰æ’åˆ—çš„ï¼Œè€Œè®¡ç®—ç»“æœåˆ™æ˜¯æœ‰åºçš„ï¼ˆè‡ªç„¶é¡ºåºï¼‰ã€‚'
        },
        {
            id: 6,
            category: 'fft_algo',
            categoryName: 'FFTç®—æ³•',
            question: 'åŸº-2 DIF-FFTï¼ˆæŒ‰é¢‘ç‡æŠ½é€‰çš„FFTï¼‰ç®—æ³•çš„è¾“å…¥å’Œè¾“å‡ºåºåˆ—çš„é¡ºåºæ˜¯ï¼Ÿ',
            options: [
                'è¾“å…¥è‡ªç„¶é¡ºåºï¼Œè¾“å‡ºç ä½å€’åº',
                'è¾“å…¥ç ä½å€’åºï¼Œè¾“å‡ºè‡ªç„¶é¡ºåº',
                'è¾“å…¥å’Œè¾“å‡ºå‡ä¸ºè‡ªç„¶é¡ºåº',
                'è¾“å…¥å’Œè¾“å‡ºå‡ä¸ºç ä½å€’åº'
            ],
            correct: 0,
            explanation: 'DIF-FFTï¼ˆDecimation-In-Frequencyï¼‰ç®—æ³•ä¸DIT-FFTç›¸åï¼Œå®ƒåœ¨é¢‘åŸŸè¿›è¡ŒæŠ½é€‰ã€‚å…¶è¾“å…¥åºåˆ—æ˜¯è‡ªç„¶é¡ºåºçš„ï¼Œç»è¿‡å„çº§è¶å½¢è¿ç®—åï¼Œè¾“å‡ºçš„é¢‘åŸŸåºåˆ—æ˜¯ç ä½å€’åºï¼ˆbit-reversalï¼‰æ’åˆ—çš„ã€‚'
        },
        {
            id: 7,
            category: 'fft_algo',
            categoryName: 'FFTç®—æ³•',
            question: 'å¯¹äºä¸€ä¸ª8ç‚¹FFTï¼Œè¾“å…¥åºåˆ—çš„ç´¢å¼•ä¸º3ï¼ˆäºŒè¿›åˆ¶ä¸º011ï¼‰ï¼Œå…¶ç ä½å€’åºåçš„ç´¢å¼•æ˜¯å¤šå°‘ï¼Ÿ',
            options: [
                '3 (011)',
                '5 (101)',
                '6 (110)',
                '1 (001)'
            ],
            correct: 2,
            explanation: 'ç ä½å€’åºï¼ˆbit-reversalï¼‰æ˜¯æŒ‡å°†ç´¢å¼•çš„äºŒè¿›åˆ¶è¡¨ç¤ºè¿›è¡Œç¿»è½¬ã€‚å¯¹äº8ç‚¹FFTï¼Œç´¢å¼•éœ€è¦3ä½äºŒè¿›åˆ¶è¡¨ç¤ºã€‚ç´¢å¼•3çš„äºŒè¿›åˆ¶æ˜¯011ï¼Œç¿»è½¬åå¾—åˆ°110ï¼Œå…¶åè¿›åˆ¶å€¼ä¸º $1*4 + 1*2 + 0*1 = 6$ã€‚'
        },
        {
            id: 8,
            category: 'dft_props',
            categoryName: 'DFTæ€§è´¨',
            question: 'DFTçš„ä¸€ä¸ªé‡è¦æ€§è´¨æ˜¯å¾ªç¯å·ç§¯å®šç†ã€‚å¦‚æœä¸¤ä¸ªNç‚¹åºåˆ— $x_1[n]$ å’Œ $x_2[n]$ çš„Nç‚¹å¾ªç¯å·ç§¯ä¸º $y[n]$ï¼Œé‚£ä¹ˆå®ƒä»¬çš„Nç‚¹DFT $X_1[k]$, $X_2[k]$ å’Œ $Y[k]$ æ»¡è¶³ä»€ä¹ˆå…³ç³»ï¼Ÿ',
            options: [
                '$Y[k] = X_1[k] + X_2[k]$',
                '$Y[k] = X_1[k] * X_2[k]$ (çº¿æ€§å·ç§¯)',
                '$Y[k] = X_1[k] \\cdot X_2[k]$',
                '$Y[k] = X_1[k] / X_2[k]$'
            ],
            correct: 2,
            explanation: 'å¾ªç¯å·ç§¯å®šç†æŒ‡å‡ºï¼šæ—¶åŸŸä¸­çš„Nç‚¹å¾ªç¯å·ç§¯ç­‰ä»·äºé¢‘åŸŸï¼ˆDFTåŸŸï¼‰ä¸­å¯¹åº”ç‚¹çš„ä¹˜ç§¯ã€‚å³ $\\text{DFT}(x_1[n] \\circledast_N x_2[n]) = X_1[k] \\cdot X_2[k]$ã€‚è¿™ä¸ªæ€§è´¨æ˜¯åˆ©ç”¨FFTå¿«é€Ÿè®¡ç®—å·ç§¯çš„åŸºç¡€ã€‚'
        },
        {
            id: 9,
            category: 'fft_app',
            categoryName: 'FFTåº”ç”¨',
            question: 'åˆ©ç”¨FFTè®¡ç®—ä¸¤ä¸ªæœ‰é™é•¿åºåˆ— $x[n]$ï¼ˆé•¿åº¦Lï¼‰å’Œ $h[n]$ï¼ˆé•¿åº¦Mï¼‰çš„çº¿æ€§å·ç§¯ï¼Œéœ€è¦å¯¹ä¸¤ä¸ªåºåˆ—è¡¥é›¶åˆ°è‡³å°‘å¤šé•¿ï¼Œå†åšDFTï¼Ÿ',
            options: [
                '$\\max(L, M)$',
                '$L+M-1$',
                '$L+M$',
                '$L \\cdot M$'
            ],
            correct: 1,
            explanation: 'çº¿æ€§å·ç§¯çš„ç»“æœåºåˆ—é•¿åº¦ä¸º $L+M-1$ã€‚ä¸ºäº†ç”¨å¾ªç¯å·ç§¯æ¥æ¨¡æ‹Ÿçº¿æ€§å·ç§¯ï¼Œå¿…é¡»é¿å…ç”±äºå‘¨æœŸæ€§å¸¦æ¥çš„æ··å ã€‚å› æ­¤ï¼Œéœ€è¦å°†ä¸¤ä¸ªåºåˆ—éƒ½è¡¥é›¶ï¼ˆzero-paddingï¼‰åˆ°é•¿åº¦ $N \\geq L+M-1$ï¼Œç„¶åè¿›è¡ŒNç‚¹DFTã€ç›¸ä¹˜ã€å†IDFTï¼Œå¾—åˆ°çš„ç»“æœæ‰æ˜¯çº¿æ€§å·ç§¯ã€‚'
        },
        {
            id: 10,
            category: 'fft_app',
            categoryName: 'FFTåº”ç”¨',
            question: 'å¯¹ä¸€ä¸ªæœ‰é™é•¿åºåˆ—è¿›è¡Œè¡¥é›¶ï¼ˆzero-paddingï¼‰åå†åšDFTï¼Œè¿™åœ¨é¢‘åŸŸä¸Šä¼šäº§ç”Ÿä»€ä¹ˆæ•ˆæœï¼Ÿ',
            options: [
                'æ”¹å˜äº†åŸå§‹ä¿¡å·çš„é¢‘è°±å½¢çŠ¶',
                'æé«˜äº†é¢‘è°±çš„çœŸå®åˆ†è¾¨ç‡',
                'å¢åŠ äº†é¢‘åŸŸçš„é‡‡æ ·ç‚¹æ•°ï¼Œä½¿é¢‘è°±æ›²çº¿æ›´å¹³æ»‘',
                'å‡å°äº†é¢‘è°±çš„å¹…åº¦'
            ],
            correct: 2,
            explanation: 'è¡¥é›¶æ“ä½œä¸ä¼šæ”¹å˜åŸå§‹ä¿¡å·çš„DTFTï¼ˆå³é¢‘è°±çš„åŒ…ç»œå½¢çŠ¶ï¼‰ï¼Œå› æ­¤ä¸ä¼šæé«˜çœŸå®çš„åˆ†è¾¨ç‡ã€‚ä½†æ˜¯ï¼Œè¡¥é›¶å¢åŠ äº†DFTçš„ç‚¹æ•°Nï¼Œç›¸å½“äºåœ¨åŸå§‹çš„DTFTé¢‘è°±ä¸Šè¿›è¡Œäº†æ›´å¯†é›†çš„é‡‡æ ·ã€‚è¿™ä½¿å¾—ç”»å‡ºçš„é¢‘è°±å›¾æ›´åŠ å¹³æ»‘ï¼Œæ›´å®¹æ˜“è§‚å¯Ÿåˆ°è°±å³°å’Œè°±è°·çš„ç»†èŠ‚ã€‚'
        },
        {
            id: 11,
            category: 'dft_basic',
            categoryName: 'DFTåŸºç¡€',
            question: 'å¯¹äºNç‚¹åºåˆ— $x[n]$ çš„Nç‚¹DFT $X[k]$ï¼Œé¢‘ç‚¹ $k=0$ å¯¹åº”çš„ $X[0]$ ä»£è¡¨äº†ä»€ä¹ˆï¼Ÿ',
            options: [
                'ä¿¡å·çš„æœ€é«˜é¢‘åˆ†é‡',
                'ä¿¡å·çš„ç›´æµåˆ†é‡ï¼ˆæˆ–æ€»å’Œï¼‰',
                'ä¿¡å·çš„å¹³å‡åŠŸç‡',
                'ä¿¡å·çš„å¥ˆå¥æ–¯ç‰¹é¢‘ç‡åˆ†é‡'
            ],
            correct: 1,
            explanation: 'æ ¹æ®DFTå…¬å¼ï¼Œ$X[0] = \\sum_{n=0}^{N-1} x[n] e^{-j \\frac{2\\pi}{N} \\cdot 0 \\cdot n} = \\sum_{n=0}^{N-1} x[n]$ã€‚å®ƒç­‰äºåºåˆ—æ‰€æœ‰æ ·æœ¬å€¼çš„æ€»å’Œï¼Œä»£è¡¨äº†ä¿¡å·çš„ç›´æµï¼ˆDCï¼‰åˆ†é‡ã€‚'
        },
        {
            id: 12,
            category: 'dft_props',
            categoryName: 'DFTæ€§è´¨',
            question: 'å¦‚æœä¸€ä¸ªNç‚¹åºåˆ— $x[n]$ æ˜¯å®æ•°åºåˆ—ï¼Œé‚£ä¹ˆå®ƒçš„Nç‚¹DFT $X[k]$ å…·æœ‰ä»€ä¹ˆå¯¹ç§°æ€§ï¼Ÿ',
            options: [
                '$X[k] = X[N-k]$ (å¶å¯¹ç§°)',
                '$X[k] = -X[N-k]$ (å¥‡å¯¹ç§°)',
                '$X[k] = X^*[N-k]$ (å…±è½­å¯¹ç§°)',
                'æ²¡æœ‰ä»»ä½•å¯¹ç§°æ€§'
            ],
            correct: 2,
            explanation: 'å®åºåˆ—çš„DFTå…·æœ‰å…±è½­å¯¹ç§°æ€§ï¼Œå³ $X[k] = X^*[N-k]$ã€‚è¿™æ„å‘³ç€å…¶å¹…åº¦è°±æ˜¯å¶å¯¹ç§°çš„ ($|X[k]| = |X[N-k]|$), ç›¸ä½è°±æ˜¯å¥‡å¯¹ç§°çš„ ($\\angle X[k] = -\\angle X[N-k]$)ã€‚è¿™ä¸ªæ€§è´¨å¯ä»¥ç”¨äºèŠ‚çœå­˜å‚¨å’Œè®¡ç®—é‡ã€‚'
        },
        {
            id: 13,
            category: 'dft_props',
            categoryName: 'DFTæ€§è´¨',
            question: 'Nç‚¹DFTçš„å‘¨æœŸæ€§ä½“ç°åœ¨å“ªé‡Œï¼Ÿ',
            options: [
                'æ—¶åŸŸåºåˆ— $x[n]$ æ˜¯å‘¨æœŸçš„ï¼Œå‘¨æœŸä¸ºN',
                'é¢‘åŸŸåºåˆ— $X[k]$ æ˜¯å‘¨æœŸçš„ï¼Œå‘¨æœŸä¸ºN',
                'æ—¶åŸŸå’Œé¢‘åŸŸåºåˆ—éƒ½æ˜¯å‘¨æœŸçš„ï¼Œå‘¨æœŸå‡ä¸ºN',
                'DFTæœ¬èº«ä¸å…·æœ‰å‘¨æœŸæ€§'
            ],
            correct: 2,
            explanation: 'DFTéšå«ç€æ—¶åŸŸå’Œé¢‘åŸŸçš„åŒé‡å‘¨æœŸæ€§ã€‚å®ƒå°†é•¿åº¦ä¸ºNçš„æœ‰é™é•¿åºåˆ— $x[n]$ è§†ä¸ºå‘¨æœŸä¸ºNçš„åºåˆ—çš„ä¸€ä¸ªä¸»å€¼å‘¨æœŸï¼Œå…¶å˜æ¢ç»“æœ $X[k]$ ä¹Ÿæ˜¯å‘¨æœŸä¸ºNçš„åºåˆ—çš„ä¸€ä¸ªä¸»å€¼å‘¨æœŸã€‚å³ $x[n] = x[n+N]$ å’Œ $X[k] = X[k+N]$ã€‚'
        },
        {
            id: 14,
            category: 'dft_basic',
            categoryName: 'DFTåŸºç¡€',
            question: 'Nç‚¹IDFTï¼ˆé€†ç¦»æ•£å‚…é‡Œå¶å˜æ¢ï¼‰çš„åˆæˆå…¬å¼æ˜¯ï¼Ÿ',
            options: [
                '$x[n] = \\sum_{k=0}^{N-1} X[k] e^{j \\frac{2\\pi}{N} kn}$',
                '$x[n] = \\frac{1}{N} \\sum_{k=0}^{N-1} X[k] e^{j \\frac{2\\pi}{N} kn}$',
                '$x[n] = \\frac{1}{N} \\sum_{k=0}^{N-1} X[k] e^{-j \\frac{2\\pi}{N} kn}$',
                '$x[n] = \\sum_{k=0}^{N-1} X[k] e^{-j \\frac{2\\pi}{N} kn}$'
            ],
            correct: 1,
            explanation: 'IDFTçš„åˆæˆå…¬å¼ä¸º $x[n] = \\frac{1}{N} \\sum_{k=0}^{N-1} X[k] e^{j \\frac{2\\pi}{N} kn}$ã€‚ä¸DFTå…¬å¼ç›¸æ¯”ï¼Œå®ƒæœ‰ $1/N$ çš„å½’ä¸€åŒ–å› å­ï¼Œä¸”æŒ‡æ•°é¡¹çš„ç¬¦å·ä¸ºæ­£ã€‚'
        },
        {
            id: 15,
            category: 'fft_algo',
            categoryName: 'FFTç®—æ³•',
            question: 'åŸº-2 FFTç®—æ³•çš„åŸºæœ¬è¿ç®—å•å…ƒè¢«ç§°ä¸ºâ€œè¶å½¢è¿ç®—â€ï¼Œå®ƒéœ€è¦å¤šå°‘æ¬¡å¤æ•°ä¹˜æ³•å’Œå¤æ•°åŠ æ³•ï¼Ÿ',
            options: [
                '1æ¬¡ä¹˜æ³•ï¼Œ2æ¬¡åŠ æ³•',
                '2æ¬¡ä¹˜æ³•ï¼Œ1æ¬¡åŠ æ³•',
                '2æ¬¡ä¹˜æ³•ï¼Œ2æ¬¡åŠ æ³•',
                '1æ¬¡ä¹˜æ³•ï¼Œ1æ¬¡åŠ æ³•'
            ],
            correct: 0,
            explanation: 'ä¸€ä¸ªæ ‡å‡†çš„è¶å½¢è¿ç®—è¾“å…¥ä¸ºAå’ŒBï¼Œè¾“å‡ºä¸º $A+W_N^k B$ å’Œ $A-W_N^k B$ã€‚è¿™ä¸ªè¿‡ç¨‹éœ€è¦å…ˆè®¡ç®— $W_N^k B$ï¼ˆ1æ¬¡å¤æ•°ä¹˜æ³•ï¼‰ï¼Œç„¶åå†è¿›è¡Œä¸€æ¬¡åŠ æ³•å’Œä¸€æ¬¡å‡æ³•ï¼ˆæ€»å…±2æ¬¡å¤æ•°åŠ /å‡æ³•ï¼‰ã€‚å› æ­¤æ˜¯1æ¬¡ä¹˜æ³•å’Œ2æ¬¡åŠ æ³•ã€‚'
        },
        {
            id: 16,
            category: 'dft_props',
            categoryName: 'DFTæ€§è´¨',
            question: 'å¾ªç¯æ—¶ç§»æ€§è´¨ï¼šå¦‚æœ $x[n]$ çš„Nç‚¹DFTæ˜¯ $X[k]$ï¼Œé‚£ä¹ˆåºåˆ— $x[(n-n_0)_N]$ (å¾ªç¯ç§»ä½) çš„Nç‚¹DFTæ˜¯ï¼Ÿ',
            options: [
                '$e^{-j \\frac{2\\pi}{N} kn_0} X[k]$',
                '$e^{j \\frac{2\\pi}{N} kn_0} X[k]$',
                '$X[k-k_0]$',
                '$X[k] - X[k_0]$'
            ],
            correct: 0,
            explanation: 'æ—¶åŸŸçš„å¾ªç¯ç§»ä½å¯¹åº”äºé¢‘åŸŸä¹˜ä»¥ä¸€ä¸ªçº¿æ€§ç›¸ä½å› å­ã€‚å…·ä½“æ¥è¯´ï¼Œå¦‚æœ $x[n] \\xrightarrow{DFT} X[k]$ï¼Œåˆ™ $x[(n-n_0)_N] \\xrightarrow{DFT} W_N^{kn_0} X[k] = e^{-j \\frac{2\\pi}{N} kn_0} X[k]$ã€‚'
        },
        {
            id: 17,
            category: 'fft_app',
            categoryName: 'FFTåº”ç”¨',
            question: 'åœ¨å¯¹ä¸€ä¸ªè¿ç»­ä¿¡å·è¿›è¡Œé‡‡æ ·å’ŒFFTåˆ†ææ—¶ï¼Œå¦‚æœé‡‡æ ·æ—¶é—´çª—å£æˆªå–äº†éæ•´æ•°ä¸ªå‘¨æœŸçš„ä¿¡å·ï¼Œä¼šå¯¼è‡´é¢‘è°±å‡ºç°ä»€ä¹ˆç°è±¡ï¼Ÿ',
            options: [
                'é¢‘è°±åˆ†è¾¨ç‡é™ä½',
                'é¢‘è°±æ³„æ¼ï¼ˆSpectral Leakageï¼‰',
                'æ …æ æ•ˆåº”ï¼ˆPicket-fence Effectï¼‰',
                'ç›´æµåˆ†é‡å¢å¤§'
            ],
            correct: 1,
            explanation: 'é¢‘è°±æ³„æ¼æ˜¯æŒ‡ä¸€ä¸ªé¢‘ç‡åˆ†é‡çš„èƒ½é‡æ‰©æ•£åˆ°å…¶ç›¸é‚»çš„é¢‘ç‡ç‚¹ä¸Šã€‚è¿™ä¸»è¦æ˜¯å› ä¸ºæœ‰é™é•¿åº¦çš„çŸ©å½¢çª—æˆªæ–­æ•ˆåº”ã€‚å½“æˆªå–çš„ä¿¡å·ä¸æ˜¯å‘¨æœŸçš„æ•´æ•°å€æ—¶ï¼Œä¿¡å·åœ¨æˆªæ–­ç‚¹ä¼šäº§ç”Ÿä¸è¿ç»­ï¼Œå…¶èƒ½é‡å°±ä¼šâ€œæ³„æ¼â€åˆ°æ•´ä¸ªé¢‘å¸¦ï¼Œå½¢æˆæ—ç“£ã€‚'
        },
        {
            id: 18,
            category: 'dft_basic',
            categoryName: 'DFTåŸºç¡€',
            question: 'ä¸€ä¸ªé•¿åº¦ä¸º1024çš„åºåˆ—ï¼Œåš1024ç‚¹DFTï¼Œå…¶è¾“å‡ºçš„ $X[k]$ ä¸­ï¼Œä»£è¡¨æœ€é«˜é¢‘ç‡ï¼ˆå¥ˆå¥æ–¯ç‰¹é¢‘ç‡ï¼‰çš„ç‚¹æ˜¯ï¼Ÿ',
            options: [
                '$X[1023]$',
                '$X[1]$',
                '$X[512]$',
                '$X[1024]$'
            ],
            correct: 2,
            explanation: 'å¯¹äºNç‚¹DFTï¼ˆNä¸ºå¶æ•°ï¼‰ï¼Œ$k=0$ æ˜¯ç›´æµåˆ†é‡ï¼Œ$k=1$ åˆ° $k=N/2-1$ æ˜¯æ­£é¢‘ç‡åˆ†é‡ï¼Œé¢‘ç‡é€æ¸å‡é«˜ã€‚$k=N/2$ å¯¹åº”çš„æ˜¯å¥ˆå¥æ–¯ç‰¹é¢‘ç‡ã€‚$k=N/2+1$ åˆ° $k=N-1$ æ˜¯è´Ÿé¢‘ç‡çš„é•œåƒã€‚å› æ­¤ï¼Œå¯¹äº1024ç‚¹DFTï¼Œå¥ˆå¥æ–¯ç‰¹é¢‘ç‡ç‚¹æ˜¯ $X[1024/2] = X[512]$ã€‚'
        },
        {
            id: 19,
            category: 'fft_app',
            categoryName: 'FFTåº”ç”¨',
            question: 'è¿›è¡Œ1024ç‚¹åŸº-2 FFTè¿ç®—ï¼Œéœ€è¦å¤šå°‘çº§è¶å½¢è¿ç®—ï¼Ÿ',
            options: [
                '1024',
                '512',
                '32',
                '10'
            ],
            correct: 3,
            explanation: 'å¯¹äºNç‚¹çš„åŸº-2 FFTï¼Œè¶å½¢è¿ç®—çš„çº§æ•°ä¸º $M = \\log_2 N$ã€‚å¯¹äºN=1024ï¼Œå› ä¸º $2^{10} = 1024$ï¼Œæ‰€ä»¥éœ€è¦ $\\log_2 1024 = 10$ çº§è¶å½¢è¿ç®—ã€‚'
        },
        {
            id: 20,
            category: 'dft_props',
            categoryName: 'DFTæ€§è´¨',
            question: 'å¸•æ–¯ç“¦å°”å®šç†ï¼ˆParseval\'s Theoremï¼‰åœ¨DFTä¸­çš„å½¢å¼æ˜¯ä»€ä¹ˆï¼Ÿ',
            options: [
                '$\\sum_{n=0}^{N-1} |x[n]|^2 = \\sum_{k=0}^{N-1} |X[k]|^2$',
                '$\\sum_{n=0}^{N-1} x[n] = \\frac{1}{N} \\sum_{k=0}^{N-1} X[k]$',
                '$\\sum_{n=0}^{N-1} |x[n]|^2 = \\frac{1}{N} \\sum_{k=0}^{N-1} |X[k]|^2$',
                '$\\sum_{n=0}^{N-1} x[n]^2 = \\frac{1}{N} \\sum_{k=0}^{N-1} X[k]^2$'
            ],
            correct: 2,
            explanation: 'å¸•æ–¯ç“¦å°”å®šç†æè¿°äº†ä¿¡å·åœ¨æ—¶åŸŸå’Œé¢‘åŸŸçš„èƒ½é‡å…³ç³»ã€‚å¯¹äºDFTï¼Œå®ƒè¡¨æ˜æ—¶åŸŸä¿¡å·èƒ½é‡çš„æ€»å’Œç­‰äºé¢‘åŸŸä¿¡å·èƒ½é‡æ€»å’Œçš„ $1/N$ã€‚å³ $\\sum_{n=0}^{N-1} |x[n]|^2 = \\frac{1}{N} \\sum_{k=0}^{N-1} |X[k]|^2$ã€‚è¿™ä¸ªå®šç†æ˜¯èƒ½é‡å®ˆæ’åœ¨ç¦»æ•£ä¿¡å·å¤„ç†ä¸­çš„ä½“ç°ã€‚'
        }
    ];

        let questions = [];
        let currentQuestion = 0;
        let userAnswers = new Array(20).fill(null);
        let submitted = false;
        let studentInfo = { id: '', name: '' };

        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function shuffleQuestions() {
            questions = originalQuestions.map(q => {
                const optionsWithIndex = q.options.map((option, index) => ({
                    text: option,
                    originalIndex: index
                }));
                const shuffledOptions = shuffleArray(optionsWithIndex);
                const newCorrectIndex = shuffledOptions.findIndex(
                    opt => opt.originalIndex === q.correct
                );
                return {
                    ...q,
                    options: shuffledOptions.map(opt => opt.text),
                    correct: newCorrectIndex
                };
            });
        }

        function startExam() {
            const studentId = document.getElementById('studentId').value.trim();
            const studentName = document.getElementById('studentName').value.trim();
            if (!studentId || !studentName) {
                alert('è¯·å¡«å†™å®Œæ•´çš„å­¦å·å’Œå§“åï¼');
                return;
            }
            studentInfo.id = studentId;
            studentInfo.name = studentName;
            shuffleQuestions();
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('examScreen').style.display = 'block';
            init();
        }

        function init() {
            displayQuestion();
            updateButtons();
            updateProgress();
        }

        function displayQuestion() {
            const q = questions[currentQuestion];
            const container = document.getElementById('questionContainer');
            let html = `
                <div class="question-card ${userAnswers[currentQuestion] !== null ? 'answered' : ''}">
                    <div class="question-header">
                        <span class="question-number">ç¬¬ ${currentQuestion + 1} é¢˜</span>
                        <span class="question-category ${q.category}">${q.categoryName}</span>
                    </div>
                    <div class="question-text">${q.question}</div>
                    <div class="options">`;

            q.options.forEach((option, index) => {
                const selected = userAnswers[currentQuestion] === index ? 'selected' : '';
                const label = String.fromCharCode(65 + index);
                html += `
                    <div class="option ${selected}" onclick="selectOption(${index})">
                        <div class="option-label">${label}</div>
                        <div class="option-text">${option}</div>
                    </div>`;
            });
            html += `</div><div class="explanation" id="explanation"></div></div>`;
            container.innerHTML = html;
            if (window.MathJax) {
                MathJax.typesetPromise([container]).catch((err) => console.log(err));
            }
        }

        function selectOption(index) {
            if (submitted) return;
            userAnswers[currentQuestion] = index;
            displayQuestion();
            updateProgress();
        }

        function submitAnswer() {
            if (userAnswers[currentQuestion] === null) {
                alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªç­”æ¡ˆï¼');
                return;
            }
            const q = questions[currentQuestion];
            const userAnswer = userAnswers[currentQuestion];
            const isCorrect = userAnswer === q.correct;
            const options = document.querySelectorAll('.option');
            options.forEach((option, index) => {
                if (index === q.correct) {
                    option.classList.add('correct');
                } else if (index === userAnswer && !isCorrect) {
                    option.classList.add('incorrect');
                }
                option.style.pointerEvents = 'none';
            });
            const explanation = document.getElementById('explanation');
            const icon = isCorrect ? 'âœ“' : 'âœ—';
            const style = isCorrect ? 'color: #28a745;' : 'color: #dc3545;';
            explanation.innerHTML = `
                <h4><span style="${style}">${icon}</span> ${isCorrect ? 'å›ç­”æ­£ç¡®ï¼' : 'å›ç­”é”™è¯¯ï¼'}</h4>
                <p><strong>æ­£ç¡®ç­”æ¡ˆï¼š</strong>${String.fromCharCode(65 + q.correct)}</p>
                <p><strong>è§£æï¼š</strong>${q.explanation}</p>`;
            explanation.classList.add('show');
            if (window.MathJax) {
                MathJax.typesetPromise([explanation]).catch((err) => console.log(err));
            }
            document.getElementById('submitBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'inline-block';
            if (currentQuestion === questions.length - 1) {
                document.getElementById('finishBtn').style.display = 'inline-block';
                document.getElementById('nextBtn').style.display = 'none';
            }
        }

        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                displayQuestion();
                updateButtons();
                window.scrollTo(0, 0);
            }
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                displayQuestion();
                updateButtons();
                window.scrollTo(0, 0);
            }
        }

        function updateButtons() {
            document.getElementById('prevBtn').disabled = currentQuestion === 0;
            document.getElementById('submitBtn').style.display = 'inline-block';
            document.getElementById('nextBtn').style.display = 'none';
            document.getElementById('finishBtn').style.display = 'none';
        }

        function updateProgress() {
            const answered = userAnswers.filter(a => a !== null).length;
            const progressBar = document.getElementById('progressBar');
            const percentage = (answered / questions.length) * 100;
            progressBar.style.width = percentage + '%';
            progressBar.textContent = `${answered}/${questions.length} å·²å®Œæˆ`;
        }

        function finishExam() {
            const unanswered = userAnswers.filter(a => a === null).length;
            if (unanswered > 0) {
                if (!confirm(`è¿˜æœ‰ ${unanswered} é¢˜æœªä½œç­”ï¼Œç¡®å®šè¦æäº¤å—ï¼Ÿ`)) {
                    return;
                }
            }
            submitted = true;
            calculateResults();
            document.getElementById('examScreen').style.display = 'none';
            document.getElementById('resultPanel').classList.add('show');
        }

        function calculateResults() {
            let correctCount = 0;
            let categoryScores = {
                dft_basic: { correct: 0, total: 0 },
                dft_props: { correct: 0, total: 0 },
                fft_algo: { correct: 0, total: 0 },
                fft_app: { correct: 0, total: 0 }
            };
            questions.forEach((q, index) => {
                const isCorrect = userAnswers[index] === q.correct;
                if (isCorrect) correctCount++;
                categoryScores[q.category].total++;
                if (isCorrect) categoryScores[q.category].correct++;
            });

            const percentage = (correctCount / questions.length * 100).toFixed(1);
            document.getElementById('resultStudentId').textContent = studentInfo.id;
            document.getElementById('resultStudentName').textContent = studentInfo.name;
            document.getElementById('resultScore').textContent = `${correctCount}/${questions.length}`;
            document.getElementById('accuracyRate').textContent = percentage + '%';
            let message = '';
            if (percentage >= 90) message = 'ğŸ‰ ä¼˜ç§€ï¼ä½ å¯¹DFT/FFTæŒæ¡å¾—éå¸¸æ‰å®ï¼';
            else if (percentage >= 80) message = 'ğŸ‘ è‰¯å¥½ï¼ç»§ç»­ä¿æŒï¼Œç¨åŠ å·©å›ºå°±èƒ½æ›´å¥½ï¼';
            else if (percentage >= 70) message = 'âœ“ åŠæ ¼ï¼åŸºç¡€è¿˜å¯ä»¥ï¼Œå»ºè®®å¤šå…³æ³¨ç®—æ³•ç»†èŠ‚ã€‚';
            else if (percentage >= 60) message = 'âš ï¸ åˆšåŠæ ¼ï¼Œè¯·é‡ç‚¹å¤ä¹ DFTæ€§è´¨å’ŒFFTç®—æ³•ï¼';
            else message = 'âŒ éœ€è¦åŠªåŠ›ï¼è¯·è®¤çœŸå¤ä¹ è¯¾ç¨‹å†…å®¹ï¼';
            document.getElementById('resultMessage').textContent = message;
            document.getElementById('dftBasicScore').textContent = `${categoryScores.dft_basic.correct}/${categoryScores.dft_basic.total}`;
            document.getElementById('dftPropsScore').textContent = `${categoryScores.dft_props.correct}/${categoryScores.dft_props.total}`;
            document.getElementById('fftAlgoScore').textContent = `${categoryScores.fft_algo.correct}/${categoryScores.fft_algo.total}`;
            document.getElementById('fftAppScore').textContent = `${categoryScores.fft_app.correct}/${categoryScores.fft_app.total}`;
        }

        function showReview() {
            const reviewSection = document.getElementById('reviewSection');
            const reviewContainer = document.getElementById('reviewContainer');
            let html = '';
            questions.forEach((q, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer === q.correct;
                const statusClass = isCorrect ? 'correct' : 'wrong';
                const statusText = isCorrect ? 'âœ“ æ­£ç¡®' : 'âœ— é”™è¯¯';
                html += `
                    <div class="review-question">
                        <div class="review-header">
                            <div>
                                <span class="question-number">ç¬¬ ${index + 1} é¢˜</span>
                                <span class="question-category ${q.category}">${q.categoryName}</span>
                            </div>
                            <span class="review-status ${statusClass}">${statusText}</span>
                        </div>
                        <div class="question-text">${q.question}</div>
                        <div style="margin-top: 15px;">
                            <p><strong>ä½ çš„ç­”æ¡ˆï¼š</strong>${userAnswer !== null ? String.fromCharCode(65 + userAnswer) + '. ' + q.options[userAnswer] : 'æœªä½œç­”'}</p>
                            <p style="color: #28a745;"><strong>æ­£ç¡®ç­”æ¡ˆï¼š</strong>${String.fromCharCode(65 + q.correct)}. ${q.options[q.correct]}</p>
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin-top: 15px;">
                            <strong>ğŸ“– è§£æï¼š</strong>${q.explanation}
                        </div>
                    </div>`;
            });
            reviewContainer.innerHTML = html;
            reviewSection.style.display = 'block';
            if (window.MathJax) {
                MathJax.typesetPromise([reviewContainer]).catch((err) => console.log(err));
            }
            reviewSection.scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>